import Fehlerbox from"./Fehlerbox_min.js";import liqui_planner from"./../liqui-planner_min";export default class Eingabeformular{constructor(){this._html=this._html_generieren()}_formulardaten_holen(e){return{titel:e.target.elements.titel.value,betrag:e.target.elements.betrag.value,einnahme:e.target.elements.einnahme.checked,ausgabe:e.target.elements.ausgabe.checked,datum:e.target.elements.datum.valueAsDate}}_formulardaten_verarbeiten(e){return{titel:e.titel.trim(),betrag:100*parseFloat(e.betrag),typ:!1===e.einnahme?"ausgabe":"einnahme",datum:e.datum}}_formulardaten_validieren(e){let n=[];return isNaN(e.betrag)&&n.push("Betrag"),""===e.titel&&n.push("Titel"),null===e.datum&&n.push("Datum"),n}_datum_aktualisieren(){let e=document.querySelector("#datum");null!==e&&(e.valueAsDate=new Date)}_html_generieren(){let e=document.createElement("section");return e.setAttribute("id","eingabeformular-container"),e.innerHTML='\n       \x3c!-- Formular --\x3e\n       <form id="eingabeformular" action="#" method="get"></form>\n       \x3c!-- Titel --\x3e\n       <div class="eingabeformular-zeile">\n         <h1>Neue Einnahme / Ausgabe hinzufügen</h1>\n       </div>\n       \x3c!-- Titel-Typ-Eingabezeile --\x3e\n       <div class="eingabeformular-zeile">\n         <div class="titel-typ-eingabe-gruppe">\n           <label for="titel">Titel</label>\n           <input\n             type="text"\n             id="titel"\n             form="eingabeformular"\n             name="titel"\n             placeholder="z.B. Einkaufen"\n             size="10"\n             title="Titel des Eintrags"\n             \n           />\n           <input\n             type="radio"\n             id="einnahme"\n             name="typ"\n             value="einnahme"\n             form="eingabeformular"\n             title="Typ des Eintrags"\n           />\n           <label for="einnahme" title="Typ des Eintrags">Einnahme</label>\n           <input\n             type="radio"\n             id="ausgabe"\n             name="typ"\n             value="ausgabe"\n             form="eingabeformular"\n             title="Typ des Eintrags"\n             checked\n           />\n           <label for="ausgabe" title="Typ des Eintrags">Ausgabe</label>\n         </div>\n       </div>\n       \x3c!-- Betrag-Datum-Eingabezeile --\x3e\n       <div class="eingabeformular-zeile">\n         <div class="betrag-datum-eingabe-gruppe">\n           <label for="betrag">Betrag</label>\n           <input\n             type="number"\n             min="0.01"\n             id="betrag"\n             name="betrag"\n             form="eingabeformular"\n             placeholder="z.B. 10,42"\n             size="10"\n             step="0.01"\n             title="Betrag des Eintrags (max. zwei Nachkommastellen, kein €-Zeichen)"\n             \n           />\n           <label for="datum">Datum</label>\n           <input\n             type="date"\n             id="datum"\n             name="datum"\n             form="eingabeformular"\n             size="10"\n             title="Datum des Eintrags"\n             \n           />\n         </div>\n       </div>\n       \x3c!-- Absenden-Button --\x3e\n       <div class="eingabeformular-zeile">\n         <button class="standard" type="submit" form="eingabeformular">\n           Hinzufügen\n         </button>\n       </div>',this._absenden_event_hinzufuegen(e),e}anzeigen(){let e=document.querySelector("#navigationsleiste");null!==e&&(e.insertAdjacentElement("afterend",this._html),this._datum_aktualisieren())}_absenden_event_hinzufuegen(e){e.querySelector("#eingabeformular").addEventListener("submit",e=>{e.preventDefault();let n=this._formulardaten_verarbeiten(this._formulardaten_holen(e)),t=this._formulardaten_validieren(n);if(0===t.length){liqui_planner.eintrag_hinzufuegen(n);let t=document.querySelector(".fehlerbox");null!==t&&t.remove(),e.target.reset(),this._datum_aktualisieren()}else{new Fehlerbox("Folgende Felder wurden nicht korrekt ausgefüllt:",t).anzeigen()}})}};